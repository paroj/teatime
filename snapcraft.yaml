name: teatime
version: "18.03"
confinement: strict
grade: stable
summary: Simple egg timer application for the Unity Desktop
description:  A simple egg-timer type application to time your teas. 
 Rings an alarm and displays an desktop notification, when the tea is ready. 
 Supports saving several pre-set timers.
base: core18

apps:
  teatime:
    command: desktop-launch $SNAP/share/teatime/teatime.py
    plugs: [unity7, home, pulseaudio]

plugs:
  gtk-3-themes:
    interface: content
    target: $SNAP/data-dir/themes
    default-provider: gtk-common-themes
  icon-themes:
    interface: content
    target: $SNAP/data-dir/icons
    default-provider: gtk-common-themes
  sound-themes:
    interface: content
    target: $SNAP/data-dir/sounds
    default-provider: gtk-common-themes

slots:
  # for GtkApplication registration
  teatime:
    interface: dbus
    bus: session
    name: net.rojtberg.teatime

parts:
    desktop-gtk3:
      source: https://github.com/ubuntu/snapcraft-desktop-helpers.git
      source-subdir: gtk
      plugin: make
      make-parameters: ["FLAVOR=gtk3"]
      build-packages:
        - build-essential
        - libgtk-3-dev
      stage-packages:
        - libxkbcommon0  # XKB_CONFIG_ROOT
        - ttf-ubuntu-font-family
        - dmz-cursor-theme
        - light-themes
        - adwaita-icon-theme
        - gnome-themes-standard
        - shared-mime-info
        - libgtk-3-0
        - libgdk-pixbuf2.0-0
        - libglib2.0-bin
        - libgtk-3-bin
        - unity-gtk3-module
        - libappindicator3-1
        - locales-all
        - xdg-user-dirs
        - ibus-gtk3
        - libibus-1.0-5
    teatime:
        plugin: python
        source: git://git.launchpad.net/teatime
        stage-packages:
            - python3-distutils-extra
            - sound-theme-freedesktop
            - pulseaudio-utils
            - python3-gi
            - gir1.2-unity-5.0
            - gir1.2-notify-0.7
            - gir1.2-gtk-3.0
            - gir1.2-pango-1.0
        after: [desktop-gtk3]
        stage:
            - -usr/share/pkgconfig # also in desktop-gtk3
            - -usr/share/mime      # also in desktop-gtk3
